## 流量预测模型说明

### 预测模型算法

| 镜像地址 |  |
| -------- | ------------------------------------------------------ |
| 网络配置 |                   |
| 启动命令 | docker-compose up                                 |
| 应用名称 | 预测模型算法                                           |

---
#### 接口信息

| 接口描述     | 心跳接口                      |
| ------------ | ----------------------------- |
| 方法名称     | ip:port/healthcheck.do |
| 接口类型     | HTTP-POST or  HTTP-GET 请求 body类型使用form-data        |
| 接口返回方式 | JSON                          |



#### 请求参数

无


#### 返回参数

```json
{"success": true, "msg": "心跳检测成功..."}
```
---
#### 接口信息

|接口描述| 延时型接口：通过文件上传告警数据（开启任务）|
| ------------ | -------------------------- |
| 方法名称| ip:port/get_flow|
| 接口类型| HTTP-POST 请求|
| 接口返回方式 | JSON|



#### 请求参数

```json
无
```
warn_data_url：是通过文件上传接口上传后，得到返回参数中file_url字段。通过主机IP:端口+file_url字段值得到。
* 1 warn_data:告警文件格式：csv
* 2 原始数据对列顺序要求：日期,编码,地区,流量,月份,天,小时。
* 3 告警文件对列名没有强行要求。


#### 返回参数

```json
{   
    "code": 200, 
    "msg": "Check successed.", 
    "body": 
        {
        "ret": "4000", 
        "work_id":"ed153719796e7c21d9bd95e4e086b0ab"
        "download_url":"http://127.0.0.1:8071/static/download/148377424588decc1230210105076960.csv"
        }
}
```

#### 参数描述
|参数名|是否必选|数据类型|描述|
| ------------ | -----|------|--------------- |
|ret|是|整型|返回码：4000表成功，其他表失败|
|pre_time|否|整型|预计处理时间，单位：秒,上传失败则没有该参数|
|work_id|否|字符串|用于一次任务的唯一标示，在取结果数据时作为入参传入。上传失败则没有该参数|
|download_url|否|字符串|用于对结果文件进行下载，需要等待处理结果达到100%后才能生效。上传失败则没有该参数|
#### 错误码
#### 错误码
|错误码|错误说明|
| ----|----- |
|4000|成功，任务开始启动|
|4001|没有告警文件url或url不合法|
|4002|服务器异常|
|4003|告警文件下载失败，或告警文件不符合要求|
|4004|请求方式错误，需要POST请求|

---                                         
#### 接口信息

| 接口描述|进度查询|
| ------------ | --------------------------- |
| 方法名称| ip:port/get_resu_process|
| 接口类型| HTTP-POST 请求|
| 接口返回方式 | JSON|



#### 请求参数

```json
{"work_id":"48aaa2e8deaa3d4f27142445bfc36cd1"}
```

#### 返回参数

```json
{
    "code": 200, 
    "msg": "task complete",
    "body": 
    {
        "ret": "5000", 
        "process": "100%"
    }
}
```
### 响应参数说明

|参数名|是否必选|数据类型|描述|
| --- | ------|-------|---|
|ret|是|字符型|返回码：5000表成功，其他表失败|
|process|是|字符型|任务处理进度|



#### 错误码

|错误码|错误说明|
| ------------ | --------------------- |
|5000|请求成功|
|5001|任务执行存在错误，不存在进度文件，重新上传开启任务|
|5002|请求方式错误，需要POST请求|
---

#### 接口信息
|接口描述| 结果文件下载 |
| ------------ | -------------------------- |
|方法名称| ip:port/get_download_resu|
|接口类型| HTTP-POST 请求|
#### 请求参数

```json
{"work_id":"48aaa2e8deaa3d4f27142445bfc36cd1"}
```
#### 错误码

|错误码|错误说明|
| ------------ | --------------------- |
|6001|workID错误|
|6002|请求方法错误|
|其他|正常则返回文件|


---

#### 接口信息
|接口描述| 文件上传 |
| ------------ | -------------------------- |
|方法名称| ip:port/upload_file|
|接口类型| HTTP-POST 请求|
#### 请求参数

```json
{"warn_file":文件}
```
#### 返回参数

```json
{"file_url": "static/upload/77aab76c-8a53-4590-94f2-fd9a3dc10397.csv",
  "ret": "6002"
        }
```
#### 错误码

|错误码|错误说明|
| ------------ | --------------------- |
|6000|正确|
|6001|文件上传key错误，必须用warn_file|
|6002|未知错误|





#### 接口流程图
![Image text](https://s1.ax1x.com/2020/05/27/tkbkxP.png)

